{"componentChunkName":"component---src-templates-blog-post-jsx","path":"/xfce-panel-slack-window-icon/","webpackCompilationHash":"e300dd9b5a798c444b71","result":{"data":{"site":{"siteMetadata":{"title":"Este es un Hotfix!","author":"Veronica Clavijo"}},"markdownRemark":{"id":"45a7b26f-c754-5169-87a4-86156b0ae324","excerpt":"Por un tiempo me ha estado molestando mucho que algunas aplicaciones (Slack, React-Native Debugger y algunas otras instaladas con ) se vean sin icono en el…","html":"<p>Por un tiempo me ha estado molestando mucho que algunas aplicaciones (<a href=\"https://slack.com/intl/en-bo/downloads/linux\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Slack</a>, <a href=\"https://github.com/jhen0409/react-native-debugger\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">React-Native Debugger</a> y algunas otras instaladas con <code class=\"language-text\">.deb</code>) se vean sin icono en el panel de programas de XFCE.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 358px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/b465d15f4d1a95b12c42b573c0fe3a57/f948d/window-panel.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 9.217877094972067%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAeUlEQVQI1w3MSw7CIBQAwJ7GqEER+vjDK580LanWNNGNunXj/Q8gB5jpFo5U6vtzG+bl91HfdzgwhWO9PV42oBuSMC6kHMuIufRKYyoO4+5IKMhO94ZwUeqkY95mulbYU/AxT9eVCdnkmQMDqayX1p8YgDataJhc+B8YoBw5kX9iCwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Panel de XFCE con icono faltante de Slack\"\n        title=\"Panel de XFCE con icono faltante de Slack\"\n        src=\"/static/b465d15f4d1a95b12c42b573c0fe3a57/f948d/window-panel.png\"\n        srcset=\"/static/b465d15f4d1a95b12c42b573c0fe3a57/cf440/window-panel.png 148w,\n/static/b465d15f4d1a95b12c42b573c0fe3a57/d2d38/window-panel.png 295w,\n/static/b465d15f4d1a95b12c42b573c0fe3a57/f948d/window-panel.png 358w\"\n        sizes=\"(max-width: 358px) 100vw, 358px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Al parecer es un bug de la aplicación en si o quizas algo con las aplicaciones Electrón en Debian, incluso pasa cuando se instala con SnapStore. De cualquier manera me molesta.</p>\n<p>Me pasé un buen rato investigando y el item <a href=\"https://docs.xfce.org/xfce/xfce4-panel/4.12/tasklist\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Window Buttons</a> obtiene su configuracion mediante los archivos <code class=\"language-text\">.desktop</code> de los diferentes programas. Buscando este archivo de Slack da como resultado:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ sudo find / -iname &quot;*slack*.desktop&quot;\n\n# Output\n/home/veuge/.config/autostart/slack.desktop\n/usr/share/applications/slack.desktop</code></pre></div>\n<p>El archivo en el directorio <code class=\"language-text\">$HOME/.config/autostart</code> es un symlink del de <code class=\"language-text\">/usr/share/applications</code>, entonces con arreglar este es suficiente. El contenido de este <code class=\"language-text\">.desktop</code> es:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ cat /usr/share/applications/slack.desktop\n\n# Output\n[Desktop Entry]\nName=Slack\nStartupWMClass=Slack\nComment=Slack Desktop\nGenericName=Slack Client for Linux\nExec=/usr/bin/slack %U\nIcon=/usr/share/pixmaps/slack.png\nType=Application\nStartupNotify=true\nCategories=GNOME;GTK;Network;InstantMessaging;\nMimeType=x-scheme-handler/slack;</code></pre></div>\n<p>La linea interesante aqui es <code class=\"language-text\">Icon=/usr/share/pixmaps/slack.png</code>, el archivo de imagen especificado es totalmente válido, existe y tiene permisos correctos.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ ls -l /usr/share/pixmaps/slack.png \n\n# Output\n-rw-rw-r-- 1 root root 38884 Mar 15 20:12 /usr/share/pixmaps/slack.png</code></pre></div>\n<p>Como parece que todo anda bien en la configuración pareciera que es un bug en aplicaciones de <a href=\"https://www.electronjs.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ElectronJS</a>, así que debe haber alguna otra manera de arreglar esto. Por suerte encontré <a href=\"https://www.reddit.com/r/xfce/comments/g3m4zk/icon_absent_for_snap_package_installed/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">esta</a> discusión, como dice el segundo comentario la solución o workaround es modificar el icono una vez que esté abierta la aplicación, para esto se siguen dos pasos</p>\n<ol>\n<li>Obtener el ID de la ventana de Slack utilizando <code class=\"language-text\">xwininfo</code>.</li>\n<li>Actualizar el icono de la ventana utilizando el ID con <code class=\"language-text\">xseticon</code>.</li>\n</ol>\n<p>Siguiendo estos pasos manualmente el proceso es:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">$ xwininfo -root -tree | sed -e &#39;s/^ *//&#39;| grep -E &#39;0x.*Slack\\s{1}\\|&#39; | awk &#39;{print $1}&#39;\n\n# Output\n0x4400005\n\n$ xseticon -id 0x4400005 /usr/share/pixmaps/slack.png</code></pre></div>\n<p>Una vez se ejecuta el comando <code class=\"language-text\">xtseticon</code> el resultado es:</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 369px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/be7703efd90f2a358404b77e2abbe573/63a25/window-panel-after.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 8.672086720867208%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAIAAADXZGvcAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAeklEQVQI1w3MTQrCMBBA4Z7GhbaEdDrJJJMfbZoqVYoKKthljuD9wWwffK8Riq6PNd3W7Um/wh0yst9K4XB0cVSWjQsx5ZgmzX4w9pRnAbjbt2Bd0wKOl9nn8zLJ770/AIGiz/sF2mh2EpXoh7qwPtReGTnfSahYoP4DJcMcebBwl6UAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Panel de XFCE con icono válido de Slack\"\n        title=\"Panel de XFCE con icono válido de Slack\"\n        src=\"/static/be7703efd90f2a358404b77e2abbe573/63a25/window-panel-after.png\"\n        srcset=\"/static/be7703efd90f2a358404b77e2abbe573/cf440/window-panel-after.png 148w,\n/static/be7703efd90f2a358404b77e2abbe573/d2d38/window-panel-after.png 295w,\n/static/be7703efd90f2a358404b77e2abbe573/63a25/window-panel-after.png 369w\"\n        sizes=\"(max-width: 369px) 100vw, 369px\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>Obviamente como dice la discusión en Reddit, no es optimo seguir ese proceso manualmente cada que se abre Slack (o cualquier otra aplicación con este problema), entonces la manera de actualizar es modificando el parametro <code class=\"language-text\">Exec</code> en <code class=\"language-text\">/usr/share/applications/slack.desktop</code> para modificar el icono cuando hay la certeza que Slack ha iniciado.</p>\n<p>Para esto el repliqué el proceso descrito en <a href=\"https://www.reddit.com/r/xfce/comments/g3m4zk/icon_absent_for_snap_package_installed/fnvijl2?utm_source=share&#x26;utm_medium=web2x&#x26;context=3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">este comentario</a> dentro de un <a href=\"https://github.com/Veuge/Configuration-files/blob/master/slack-init.sh\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">script</a>, y finalmente ese script ejecutarlo en <code class=\"language-text\">slack.desktop</code>.</p>\n<p>Desglosando el script:</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"># Permite sobreescribir el .desktop\nenv BAMF_DESKTOP_FILE_HINT=$SLACK_DESKTOP\n\n# Comando que abre Slack minimizado y sin output\n/usr/bin/slack -u %U &amp; &gt; /dev/null\n\n# Pausa para esperar que Slack inicie\nsleep 10\n\n# Obtiene window ID de Slack y lo guarda en la variable app_wid\napp_wid=$(xwininfo -root -tree |sed -e &#39;s/^ *//&#39;|grep -E &#39;0x.*Slack\\s{1}\\|&#39; | awk &#39;{print $1}&#39;)\n\n# Actualiza el ícono dado el window ID y el icono en png.\nxseticon -id $app_wid $SLACK_ICON</code></pre></div>\n<p>Y utilizando el script en el archivo <code class=\"language-text\">.desktop</code> en <code class=\"language-text\">Exec</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">[Desktop Entry]\nName=Slack\nStartupWMClass=Slack\nComment=Slack Desktop\nGenericName=Slack Client for Linux\nExec=sh -c /home/veuge/slack-init.sh\nIcon=/usr/share/pixmaps/slack.png\nType=Application\nStartupNotify=true\nCategories=GNOME;GTK;Network;InstantMessaging;\nMimeType=x-scheme-handler/slack;</code></pre></div>\n<h2 id=\"conclusión\"><a href=\"#conclusi%C3%B3n\" aria-label=\"conclusión permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Conclusión</h2>\n<ul>\n<li>Esta solución es solo un workaround para restaurar el icono de Slack y otras aplicaciones en XFCE, idealmente se deberia determinar exactamente la razon por la cual el icono no está disponible.</li>\n<li>El workaround funciona bien cuando se inicia manualmente Slack y cuando está entre la aplicacion que se auto-inician al iniciar sesión.</li>\n<li>Se puede mejorar el script para hacerlo mas configurable para que sea extensible a otras aplicaciones con este error en el ícono. (Lo haré en algun momento…)</li>\n</ul>","frontmatter":{"title":"¿Cómo arreglar el icono de Slack en Debian - XFCE","date":"April 22, 2021","description":"Lorem ipsum"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/xfce-panel-slack-window-icon/","previous":{"fields":{"slug":"/tmux-semi-automatizacion/"},"frontmatter":{"title":"Semi-automatización de TMUX"}},"next":null}}}